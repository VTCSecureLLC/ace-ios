language: objective-c
osx_image: xcode7
env:
  global:
  - KIF_SCREENSHOTS=$PWD/Screens
  - secure: dW1NTqHU0R2bARHOuDJGbZIXPf8ssWhZ32NmdqDezGJsPsl3mQ5lMUuI4uslar2nPgRz19/R7vJpC6xZs86LSLu4qe/r2UhOQf3Hsn2Y6S3qzRGqDr2oQX1CNpLtE4Ont3jxewm+nHIJSBJ3rkdlrruT8Mh1uTV8WlwrURgFpfIVtunUkEhY6shjrfndUue+ppyKKB3PVXFCe56K8+34SaRHzl5LsBdSK4FVlIwTywbvMbynPuAnprx8DvInnyHdLELrCS6xPOa4tyXh3Agi9S7ESJx6IFW0emHZv1+5moBNgwbv555J11Ffj/HjHgbPYEKiSjEb03sOUAu/8dprCg1yCtgFAU+a6WqkCyHaPBThta25lHj8HBKrsvwzhfAIkCz1HadzepppIhdDiaGLrT3RBTbo7tX4ZVSnoVwkWCltahpHLdiYq1ssLjfDI5uVfM1YIqtlRGpGk8sdx5588y3dSlRAPmmuO79drnVempvs1XQmT4cQsJxbrm1hFC7UObJGoS3ExYTOBrCJlOl7YZDUwnjCS4FWRh2eLD/LyNi9biN9PvTtDTyamx7PtjnSe2xhw3JlHd6TU6PI9OmjGduwIsYsIo+Gz+WbLRpPSB4MKWrl2ACRHs+uX9geqFhKfB5fvkncrCT9M5FyfF5eG7EtEsfiooX7d5CnEI65Mpw=
  - secure: elXhhgesU8NZYg1dWICyz4N1hka68ZA4nxgQhlsWv6fSiQ4S6BM92/xO7/FZDpJptPLBjNkV62pC/XO45/bVazqWacN7Mk6wVe9qBZG5WlhheEDLOg7+0hn17R9yb8O6YOW2UfVwQZKDps/WUmaVlwoW9leUG2fm/NF8Et8G/0asBbZLVPnsaWe+EstumTGb6fHujE6q+kiPdpPhS6n4MZX02rpoXIAurmfix+bmptejyobgDz7NdHAh9dWRY3kR0k6QH4g58jeJY1caVIkLL99aBJxG/HGx9Mh+OnTekTsG1Bs7PYTUvTjHhdDagDTtMNQKZYnGM8uTxmQEqLC/gw4GEJLaT7ecYeWeKaGr5rSOKeumzpP+oclehJVNa2dazEggr3/0JHvkGKA6zMszEmxA5M+UbVxRxPMz9gyKJt5npFTJekbq12IgD85HN5NA4matvQW1F+D9PDaw4L8aj6vaFVHtdWagKYxo2fHqftITSONF04ibjhQzMSDvqfZBT0fUmj/eROOnXDQU/BhzLEUCt76LmR803UW+ZN2rpOoLBxf6NFHPJwBrTX2HV4ax7RbzbvnHkQlpSXtDqxuz4rFu7Iq78rfI8N1NyxQmZfkXy2amlvxFO24HGpp2kaSa0aBq0kvAsLeNu4DRCxDtXHzbCYf709AogaY1XkDXyJE=
  - secure: kPmLmcPyJC/ZM937WoO9yEA9jIpZsLlDhdjk0bgDWyccr7GuESYVN9mYj6NwfYIddE9BeqUQLAsTh484RgEXShUIoY1lk/+9uB4uzPa3cfWK7z3sQaYNbnYZBZ/HBghOK4hXQosonP8byCGhbG7/SZTbIIlHJ9xSNS9kIy/KxSAiJ1kNkFZEzFStNANfUqsJuWkySGLqpm1A/mGDW8umdKWdDFzDwxumuCVU8Nnv7wGRb32zWoiINvrRiJw1wqoJ4FbaH+lRAJUeaCt/Sn7WNFNPyZUKOIfCD29UUiLUVSYfjF1dCDIRnjEu0sDzy1rG5LaogDdh1U7px7buzZlxAn87sjvSfKAN76HO/c95lR3F8QZ+nCdRzBOaO3uCyop+zT8P9WEbMufwOIh/bJuYVemANIIb9V3Wb9R8w33NHMsC9H/pjgNXFgj6/wkBEhcENhOs/vrgeV6vGcdyli+5nqSZZk+1oXrvd9w8Tbru6D6mEP+0ntNR0grIxEQ8JmIdquZ193AHSb911swdG/0gSCKAV8nmx5iB1eVYGKv8QTEEB3RqX3bvDbJhGqHpybLiyfydn2MwWtfF1tTfOLLMMdTM5Ko95xWXG/1PDAkNgihEZdCyh0aa1UZsZoejlUYsFK6+DABb+odvN8Vr4nDsnTH04aUzWy8iVNa8bBg3MxQ=
  - secure: HxMqVKiIZHH+vqsPcaCme7pfk53EzLleTzMGZbBzjLXFaYkjjQv55qDrj1KJrYDhCArIdZ5lGMwlrwamojhMQAO002WRSFtf1kdrrw5NbTxQHoPns3b4KnKyjwSDxKCy9LjcT58XNXXmL07/eInWAeTwDUaXXWdmuVDyw6Wddrzq/bNLemKiq0V5IFCgevUaCqG2bpQdKr0C8SrxdTgzSZL4bAZ6Dwbuqbj7Bwie9TqHne/PYGSkw7UmhJljRpikceyt3iPVLsaQwOAzPIRA4CLUPyAwLcYgwlbGIgLSQKZO2YaaXlHbW+cLplRihYRwfH0q3/K3TaF92aEH5QJaKo3YoKqBB871Tu/jsO7QwRPJLBLDdpOGxeNpxfCusVsJwQg4tvjrhRLPeS3kssONQ1UDCgNCbJDkPfiP1vZToZYAbm5ouSqxFwduFqhwVQUyYN4+NvYFqPgGPkrKxW2VzE8ltJJDLByCrGtzl6zCGsR0YmfxH7OtdhQSNevCWY375LcUZto1w5kNU5ejx5iGTTgxRS/9CsgIwa286VesLtMu3v7Si8nmYpj1qHd+25sfNEbQhIH3MNEZWrbM3yp2649fyHBYawQalt5tupnLHXrUcx4Or3+2Gv9lSw+XnZvkyeKQcX7n7hQt7Q/qPnE4MofO8PHt99HXRcoKdX1MN3s=
  - secure: cMxsQUmGsFK7Cu4simbUM117bswQzgxspI7taB7wR4NDzM2Xnm6tSq8AK2EuQRpEAPgZGotL/eWG9GG+bzJFCR7I7EoC479ql3kxNaMd1fssFV9LJd/q2bKNkGLXFom3bLrPRi7svRU3tDCNUPmpwYd+Zb1odr98qMnZzOyogO+A3eqt5CSZCdTKjg3zQ+GGhMyhqUitCAfe+BritypU0M6xwAY8Sv7U0g5DcwEcXmEYw5ZoG5GvX/VzFeJeDL/qUz1rCTVVoAbp16LxFVDN+xTaiGSX4+jb3WRdj3VLImE5PeNe1dQt3IJvfCz2MzX5QCKTv32yfCALi8Sj6XWtfFy41L+LD4QnJAah8HOUNnGuoW896Anp7ZtcGRYdsObkJ8T/3bhl6dN/5RT1H1YqoH6Q4RfJbKJ1wOumxOwmqI8ALE1YXljJ5Gvb9fgiKUBSUPSht9bX563cRzt0bGGi8FtpRxSL4TnJugShd22kM5j6lgR88ITiVortQx31BCF1XrUt3VgQxAgmOwIYSON+y20CNZMuc7jVgyt3K2oEJCIhNcvRlu5yEpTO3Dv1/aD4kXJY+ftviImRmkE+PGq4HuXF2KvUeSjDHbRt7nw/SX1a4HOQ29aZA34ThZsucPIXi1/oCaXtV1ca+6RJX77p4TmIgQzlYmtmQOhwIIsynU8=
  - secure: Hc+/GHaGEwdWApgu4Iscx+VageFtlSRwGiRbTmdAFFG/jYEtEBH/kazbehb3TSGUPqdXBFA6EvHvF0duwsdkY/ECwM1spW/NiueLXgOfyCNWtK3R88zsEc29mY5dBAC6gzctQPCsYhLdQAfH+uspJtWbM/Fb5O/SsTqMRdby3u0zIBLLvbYISWWeaYz+wakwAzZBbPpFv74T/Mh4ExQiEHiScpPo3ulxztguJOMV8mFpL/XSeS7UWjA24xZPuYWQlwcDJdSFooG4u5uK3sCpDj8jos7hbB7STgYFyC2Ym6spFvKVxgC9p8wmRev0ccOtcA8U8lyRSK99a58RAFtjMFw8YeiuGtSTw8EGrgbHzA0puRGJNW/mjcVaLF2uTwHxIr8ZecFGyFCFSaZA6CRMjq2lHEOI3A+C2MF9YrpozABOvdPQmnAHQPmt1r88ywwR3xC1CgdDAPGVFQADMMIdchQKIkWdZrSFFBb3LNaWw6Wk9oRlUzfl/uCdVmPJm2jxasXMkfXKk4ADxq8oeI6EiuvUr7OMKISsBDkUzFHJPws1rkJvjodrXH2BcorHpFLCK076j/uYAUuDSYJfYtFAqwXB23gpemUOQ/xiKU4ZhIasz004nXuOqcfz+uLLeRcKHO2m8zwvmd8yoJlLqDfv6tJRVQSKpKBiE/cmWhlQyTM=
before_install:
- pushd /usr/local/Library/Homebrew/ ; git branch --set-upstream-to=origin/master master ; git pull ; popd
- brew update 1>/dev/null
- brew install doxygen nasm yasm optipng imagemagick intltool ninja antlr cmake
- wget --no-check-certificate https://raw.githubusercontent.com/FFmpeg/gas-preprocessor/master/gas-preprocessor.pl
- chmod +x gas-preprocessor.pl
- sudo mv gas-preprocessor.pl /usr/local/bin
- sudo ln -s /usr/local/bin/glibtoolize /usr/local/bin/libtoolize
- git submodule update --init --recursive
- bundle install
install:
- "./prepare.py -d devices -G Ninja -DENABLE_WEBRTC_AEC=ON -DENABLE_H263=YES -DENABLE_FFMPEG=YES -DENABLE_H263=YES 
  -DENABLE_AMRWB=YES -DENABLE_AMRNB=YES -DENABLE_OPENH264=YES -DENABLE_G729=YES -DENABLE_MPEG4=YES -DENABLE_H263P=YES
  --enable-non-free-codecs --enable-gpl-third-parties -DENABLE_VCARD=YES"
- "./Tools/build_script.sh"
script:
- "./Tools/archive_script.sh"
after_success:
- "./Tools/release.sh"
notifications:
  flowdock:
    secure: XulX1WBdwcW09KFJOfPgRNzb08jGavzPPfpj9slg5Xk9Ib83cduJo04wVanbA92xVBsgLPNPvuu441LFqNRn3w6xbVDA75JyTmT1ih+W8VaaBZLfovrAbmpBEpXk3VUqn7UID+Hl/rkfYO+9fw+qPzJnomRMZ04ldc8hUfHH3ImfO3B8dMt1IMSaoy88A7f4/Vm4EGXWDDY35ZJxO560w5Rr9QgiALllpHdgxHDScJK73RceDi75gUfvNIZqW7c/AQI7dJ6QbQ15Esw2i/x5eHIGMYCheXPiazW6/3GONrz5cmcZ7ecEDPLMVvzKS38DN5iAFwZ5kFixS/h30WhcVsT6ZWPcDWHyJGNWGRqpwJn/IROCb+0f6Y2BtZ4ReDEq5nHPviZvN4eTi9uvWs8jE+8wh2DpJ9VfAu8UADouzxfK7W/A5YgcQA+6Q98anlAICfwCsobcS72MWa4MoUFscKlxe8byqL+ZZWxoEGq79s6OIMuVtTqpNEaLCDflHUAv9q+hDXXyTHMGhrCplQ7b8yfv7JAmmareqnz6V+FsGj3gd6sbLK+W9TQ8y8wnJAX6ZZvfIIPbqzKHc12I5Y0jJmkTLfrrMfE5kQ8uK9GquAvMsjySNYO6+0ljcLi09+yo40gi+tcRXTYtjhjqr8O5Qj0N0I+39xF/TPiaMXKqBmk=
